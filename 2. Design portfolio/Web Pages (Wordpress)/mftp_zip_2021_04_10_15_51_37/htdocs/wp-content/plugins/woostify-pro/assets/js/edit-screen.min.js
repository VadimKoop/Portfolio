'use strict';var woostifySearchDelay=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}(),woostifyMultiSelect=function(){var a=document.querySelectorAll(".woostify-multi-selection");a.length&&a.forEach(function(a){var b=a.querySelector(".woostify-multi-select-value"),c=a.querySelector(".woostify-multi-select-selection"),d=c.querySelector(".woostify-multi-select-search"),e=a.querySelector(".woostify-multi-select-dropdown"),f=function(a){var d=c.querySelectorAll(".woostify-multi-select-id");if(!d.length)return void(b.value="default");var e=[];return d.forEach(function(a){var b=a.getAttribute("data-id");!b||e.includes(b)||e.push(b)}),!0===a?e:void(b.value=e.join("|"))},g=function(){var b=c.querySelectorAll(".woostify-multi-select-id");b.length&&b.forEach(function(b){var c=b.getAttribute("data-id"),d=b.querySelector(".woostify-multi-remove-id");d&&(d.onclick=function(){if(b.parentNode){a.classList.add("active");var d=e.querySelector("[data-id=\""+c+"\"]");d&&d.classList.remove("disabled"),b.remove(),f()}})})};g();var h=function(){var a=e.querySelectorAll(".woostify-multi-select-id");if(a.length)for(var b=0,d=a.length;b<d;b++)a[b].onclick=function(){var a=this,b=a.classList.contains("disabled"),d=a.getAttribute("data-id");if(!b){a.classList.add("disabled");var e="<span class=\"woostify-multi-select-id\" data-id=\""+d+"\">"+a.innerHTML+"<i class=\"woostify-multi-remove-id dashicons dashicons-no-alt\"></i></span>";c.insertAdjacentHTML("afterbegin",e),f(),g()}}};d&&(d.addEventListener("input",function(){var a=this,b=a.getAttribute("data-nonce"),c=a.value.trim(),d=a.name,g=new Request(ajaxurl,{method:"POST",body:"action="+d+"&security_nonce="+b+"&keyword="+c,credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});return 1>c.length?void(e.innerHTML=""):void woostifySearchDelay(function(){fetch(g).then(function(a){return 200===a.status?void a.json().then(function(a){if(a.success){var b=new DOMParser,c=b.parseFromString(a.data,"text/html"),d=c.querySelectorAll(".woostify-multi-select-id");d.length&&d.forEach(function(a){var b=a.getAttribute("data-id")||"",c=f(!0)||[];c.length&&(c.includes(b)?a.classList.add("disabled"):a.classList.remove("disabled"))}),e.innerHTML=c.body.innerHTML,h()}}):void console.log("Status Code: "+a.status)}).catch(function(a){e.innerHTML="",console.log(a)})},500)}),d.addEventListener("focus",function(){a.classList.add("active"),g()})),document.addEventListener("click",function(b){var d=b.target,e=d.closest(".woostify-multi-selection"),f=d.classList.contains("woostify-multi-remove-id"),g=d.classList.contains("woostify-multi-select-id"),h=d.classList.contains("woostify-multi-select-search");return e==a?void(c===d||f||g||h||a.classList.remove("active")):void a.classList.remove("active")})})},prevSiblings=function(a){for(var b=[],c=a;c=c.previousElementSibling;)b.push(c);return b},nextSiblings=function(a){for(var b=[],c=a;c=c.nextElementSibling;)b.push(c);return b},siblings=function(a){var b=prevSiblings(a)||[],c=nextSiblings(a)||[];return b.concat(c)},woostifyMultiDependency=function(){var a=document.querySelectorAll(".woostify-multi-dependency");a.length&&a.forEach(function(a){var b=a.querySelectorAll(".woostify-multi-dependency-item [name]");b.length&&b.forEach(function(b,c){var d=b.closest(".woostify-multi-dependency-item"),e=d.getAttribute("data-dependency");e&&b.addEventListener("change",function(){var e=b.value,f=parseInt(c)+1,g=a.querySelectorAll(".woostify-multi-dependency-item:nth-child("+f+") ~ .woostify-multi-dependency-item[data-required=\""+e+"\"]"),h=siblings(d);h.length&&h.forEach(function(a){var b=a.getAttribute("data-required");b&&a.classList.remove("active")}),g.length&&g.forEach(function(a){var c=a.getAttribute("data-required"),d=a.getAttribute("data-value"),f=new Event("change"),g=a.querySelector("[name]");g.dispatchEvent(f),"checkbox"==b.type?b.checked?a.classList.add("active"):a.classList.remove("active"):e==c?a.classList.add("active"):a.classList.remove("active")})})})})},woostifyUpdateValue=function(){var a=document.querySelector(".woostify-featured-setting");if(a){var b=a.querySelectorAll("[type=\"checkbox\"]");b.length&&b.forEach(function(a){a.onchange=function(){a.value=1==a.value?0:1}})}},woostifyDependency=function(){var a=document.querySelectorAll(".woostify-filter-value");a.length&&a.forEach(function(a){a.addEventListener("change",function(){var b=a.closest(".woostify-filter-item"),c=nextSiblings(b);c.length&&a.value.trim()&&c.forEach(function(b){var c=b.getAttribute("data-type");c&&("checkbox"===a.type?a.checked&&c==a.value?b.classList.remove("hidden"):b.classList.add("hidden"):c.includes(a.value)?b.classList.remove("hidden"):b.classList.add("hidden"))})})})},woostifyTabSettings=function(){var a=document.querySelector(".woostify-settings-section-tab");if(a){var b=a.querySelectorAll(".tab-head-button");b.length&&(b.forEach(function(b){b.onclick=function(){var c=b.hash?b.hash.substr(1):"",d=siblings(b),e=a.querySelector(".woostify-setting-tab-content[data-tab=\""+c+"\"]"),f=siblings(e);b.classList.add("active"),d.length&&d.forEach(function(a){a.classList.remove("active")}),e.classList.add("active"),f.length&&f.forEach(function(a){a.classList.remove("active")})}}),window.addEventListener("load",function(){var b=a.querySelector("a[href=\""+window.location.hash+"\"]"),c=a.querySelector("a[href=\"#general\"]");b?b.click():c&&c.click()}))}},woostifySaveOptions=function(){var a=document.querySelector(".woostify-featured-setting");if(a){var b=a.getAttribute("data-id")||"",c=a.getAttribute("data-nonce")||"",d=a.querySelector(".save-options");d&&b&&c&&(d.onclick=function(){var d=this,e=b.replace(/-/g,"_"),f=a.querySelectorAll("[name*=woostify_"+e+"]"),g={},h=a.querySelectorAll("[required=\"required\"]"),i=!1;if(a.classList.contains("woostify-ajax-search-product-setting")){var j=a.querySelector(".must-choose-one-option"),k=!!j&&j.querySelector("[type=\"checkbox\"]"),l=j?j.querySelectorAll("[type=\"checkbox\"]:checked"):[];if(!l.length&&k)return void k.focus()}if(h.length&&h.forEach(function(b){var c=b.value.trim(),d=b.closest(".woostify-setting-tab-content"),e=b.closest(".woostify-filter-item.hidden"),f=d?d.getAttribute("data-tab"):"";if(!e&&!c){var g=a.querySelector("a[href=\"#"+f+"\"]");return g&&!g.classList.contains("active")&&g.click(),i=!0,void b.focus()}}),!i){a.classList.add("loading"),d.setAttribute("disabled","disabled"),d.innerHTML=woostify_edit_screen.saving+"...",f.length&&f.forEach(function(a,b){a.value.trim()&&(a.name.includes("[]")?g[a.name+"["+b+"]"]=a.value:g[a.name]=a.value)});var m=new Request(ajaxurl,{method:"POST",body:"action=woostify_save_"+e+"_options&security_nonce="+c+"&setting_id="+b+"&options="+JSON.stringify(g),credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"})});fetch(m).then(function(a){if(200!==a.status)return void console.log("Status Code: "+a.status)}).catch(function(a){console.log(a)}).finally(function(){a.classList.remove("loading"),d.innerHTML=woostify_edit_screen.saved,setTimeout(function(){d.innerHTML=woostify_edit_screen.save,d.removeAttribute("disabled")},500)})}})}},woostifySaleNotificationRemoveMessage=function(){var a=document.querySelector(".woostify-sale-notification-box-message");if(a){var b=a.querySelectorAll(".woostify-sale-notification-remove-message");b.length&&(b.forEach(function(b){b.onclick=function(){var b=this,c=b.getAttribute("disabled")||"";if("disabled"!==c&&(b.parentNode.remove(),1>=a.querySelectorAll(".woostify-sale-notification-remove-message").length)){var d=new Event("lastMessage");document.documentElement.dispatchEvent(d)}}}),document.documentElement.addEventListener("lastMessage",function(){var b=a.querySelector(".woostify-sale-notification-remove-message");b&&b.setAttribute("disabled","disabled")}))}},woostifySaleNotificationAddNewMessage=function(){var a=document.querySelector(".woostify-featured-setting"),b=!!a&&document.querySelector(".woostify-sale-notification-box-message"),c=b?b.querySelector(".woostify-sale-notification-message-inner"):"",d=c?c.querySelector(".woostify-sale-notification-remove-message").innerHTML:"",e="<div class=\"woostify-sale-notification-message-inner\">";if(e+="<textarea name=\"woostify_sale_notification_message[]\" required=\"required\"></textarea>",e+="<span class=\"woostify-sale-notification-remove-message button\">"+d+"</span>",e+="</div>",a&&b&&c){var f=a.querySelector(".woostify-sale-notification-add-message");f&&(f.onclick=function(){b.insertAdjacentHTML("beforeend",e),woostifySaleNotificationRemoveMessage();var a=b.querySelector(".woostify-sale-notification-message-inner:last-of-type"),c=!!a&&a.querySelector("textarea");c&&c.focus();var d=b.querySelector(".woostify-sale-notification-remove-message[disabled=\"disabled\"]");d&&d.removeAttribute("disabled")})}};document.addEventListener("DOMContentLoaded",function(){woostifyMultiSelect(),woostifyDependency(),woostifyMultiDependency(),woostifyUpdateValue(),woostifyTabSettings(),woostifySaveOptions(),woostifySaleNotificationAddNewMessage(),woostifySaleNotificationRemoveMessage()});